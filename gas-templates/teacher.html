<!DOCTYPE html>
<html>
<head>
  <base target="_top">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>📊 마음날씨 일기 - 교사용 대시보드</title>
  <?!= include('teacher-styles'); ?>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <div class="container">
    <header>
      <h1>📊 마음날씨 일기 - 교사용 대시보드</h1>
      <p class="subtitle">학생들의 정서 건강을 한눈에 확인하세요</p>
    </header>

    <!-- 통계 요약 카드 -->
    <div class="stats-grid">
      <div class="stat-card">
        <div class="stat-icon">📝</div>
        <div class="stat-content">
          <div class="stat-value" id="totalDiaries">0</div>
          <div class="stat-label">전체 일기 수</div>
        </div>
      </div>
      <div class="stat-card">
        <div class="stat-icon">👥</div>
        <div class="stat-content">
          <div class="stat-value" id="totalStudents">0</div>
          <div class="stat-label">참여 학생 수</div>
        </div>
      </div>
      <div class="stat-card">
        <div class="stat-icon">📅</div>
        <div class="stat-content">
          <div class="stat-value" id="todayDiaries">0</div>
          <div class="stat-label">오늘 작성</div>
        </div>
      </div>
      <div class="stat-card">
        <div class="stat-icon">🌈</div>
        <div class="stat-content">
          <div class="stat-value" id="dominantEmotion">-</div>
          <div class="stat-label">주요 감정</div>
        </div>
      </div>
    </div>

    <!-- 알림 패널 -->
    <div class="card" id="alertPanel" style="display: none;">
      <h2>🔔 주의가 필요한 학생</h2>
      <div id="alertList" class="alert-list">
        <!-- 알림이 동적으로 추가됩니다 -->
      </div>
    </div>

    <!-- 감정 분포 차트 -->
    <div class="card">
      <h2>🎨 전체 감정 분포</h2>
      <div class="chart-container">
        <canvas id="emotionChart"></canvas>
      </div>
    </div>

    <!-- 일별 감정 추이 -->
    <div class="card">
      <h2>📈 일별 감정 추이</h2>
      <div class="date-filter">
        <label>기간 선택:</label>
        <select id="periodFilter" onchange="updateTrendChart()">
          <option value="7">최근 7일</option>
          <option value="14">최근 14일</option>
          <option value="30">최근 30일</option>
        </select>
      </div>
      <div class="chart-container">
        <canvas id="trendChart"></canvas>
      </div>
    </div>

    <!-- 최근 일기 목록 -->
    <div class="card">
      <h2>📚 최근 제출된 일기</h2>
      <div class="controls">
        <button class="btn btn-primary" onclick="loadAllData()">
          🔄 새로고침
        </button>
        <button class="btn btn-secondary" onclick="exportToExcel()">
          📊 엑셀 내보내기
        </button>
        <button class="btn btn-info" onclick="generateReport()">
          📄 리포트 생성
        </button>
      </div>
      <div id="diariesContainer" class="diaries-container">
        <!-- 일기 목록이 여기에 표시됩니다 -->
      </div>
    </div>

    <!-- 학생별 통계 -->
    <div class="card">
      <h2>👥 학생별 참여도</h2>
      <div id="studentStatsContainer" class="student-stats-container">
        <!-- 학생별 통계가 여기에 표시됩니다 -->
      </div>
    </div>
  </div>

  <!-- 로딩 오버레이 -->
  <div id="loadingOverlay" class="loading-overlay" style="display: none;">
    <div class="spinner"></div>
    <p>데이터 불러오는 중...</p>
  </div>

  <?!= include('teacher-javascript'); ?>
</body>
</html>